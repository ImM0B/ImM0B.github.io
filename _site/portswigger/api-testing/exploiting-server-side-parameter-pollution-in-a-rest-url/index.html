<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>M0B notes</title>
  <meta name="description" content="&lt;p&gt;#SSParameterPollution #API&lt;/p&gt;&lt;h2 id=&quot;study-the-behavior&quot;&gt;Study the behavior&lt;/h2&gt;">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" href="/M0B.png" type="image/png">
  <style>
    /* fallback si la hoja no carga */
    body{background:#000;color:#e6e6e6;font:16px/1.7 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
  
  <script defer src="/assets/js/copy-code.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="site-brand">
      <img class="brand-logo" src="/M0B.png" alt="logo" />
      <div class="brand-title">M0B notes</div>
    </div>
    <nav class="site-nav">
      <a href="/">Inicio</a>
      <a href="/puertos/">Puertos</a>
      <a href="/escalada/">Escalada</a>
      <a href="/portswigger/">Portswigger</a>
      <a href="/hackthebox/">HackTheBox</a>
      <a href="/real_life/">Real Life</a>
      <a href="/extras/">Extras</a>
    </nav>
  </header>

  <main>
    <div class="container">
      <p>#SSParameterPollution #API</p>
<h2 id="study-the-behavior">Study the behavior</h2>

<ol>
  <li>
    <p>In Burp’s browser, trigger a password reset for the <code class="language-plaintext highlighter-rouge">administrator</code> user.</p>
  </li>
  <li>
    <p>In <strong>Proxy &gt; HTTP history</strong>, notice the <code class="language-plaintext highlighter-rouge">POST /forgot-password</code> request and the related <code class="language-plaintext highlighter-rouge">/static/js/forgotPassword.js</code> JavaScript file.</p>
  </li>
  <li>
    <p>Right-click the <code class="language-plaintext highlighter-rouge">POST /forgot-password</code> request and select <strong>Send to Repeater</strong>.</p>
  </li>
  <li>
    <p>In the <strong>Repeater</strong> tab, resend the request to confirm that the response is consistent.</p>
  </li>
  <li>
    <p>Send a variety of requests with a modified username parameter value to determine whether the input is placed in the URL path of a server-side request without escaping:</p>

    <ol>
      <li>
        <p>Submit URL-encoded <code class="language-plaintext highlighter-rouge">administrator#</code> as the value of the <code class="language-plaintext highlighter-rouge">username</code> parameter.</p>

        <p>Notice that this returns an <code class="language-plaintext highlighter-rouge">Invalid route</code> error message. ==This suggests that the server may have placed the input in the path of a server-side request,== and that the fragment has truncated some trailing data. Observe that the message also refers to an API definition.</p>
      </li>
      <li>
        <p>Change the value of the username parameter from <code class="language-plaintext highlighter-rouge">administrator%23</code> to URL-encoded <code class="language-plaintext highlighter-rouge">administrator?</code>, then send the request.</p>

        <p>Notice that this also returns an <code class="language-plaintext highlighter-rouge">Invalid route</code> error message. This suggests that the input may be placed in a URL path, as the <code class="language-plaintext highlighter-rouge">?</code> character indicates the start of the query string and therefore truncates the URL path.</p>
      </li>
      <li>
        <p>Change the value of the <code class="language-plaintext highlighter-rouge">username</code> parameter from <code class="language-plaintext highlighter-rouge">administrator%3F</code> to <code class="language-plaintext highlighter-rouge">./administrator</code> then send the request.</p>

        <p>Notice that this returns the original response. This suggests that the request may have accessed the same URL path as the original request. This further indicates that the input may be placed in the URL path.</p>
      </li>
      <li>
        <p>Change the value of the username parameter from <code class="language-plaintext highlighter-rouge">./administrator</code> to <code class="language-plaintext highlighter-rouge">../administrator</code>, then send the request.</p>

        <p>Notice that this returns an <code class="language-plaintext highlighter-rouge">Invalid route</code> error message. This suggests that the request may have accessed an invalid URL path.</p>
      </li>
    </ol>
  </li>
</ol>

<h2 id="navigate-to-the-api-definition">Navigate to the API definition</h2>

<ol>
  <li>
    <p>Change the value of the username parameter from <code class="language-plaintext highlighter-rouge">../administrator</code> to <code class="language-plaintext highlighter-rouge">../%23</code>. Notice the <code class="language-plaintext highlighter-rouge">Invalid route</code> response.</p>
  </li>
  <li>
    <p>Incrementally add further <code class="language-plaintext highlighter-rouge">../</code> sequences until you reach <code class="language-plaintext highlighter-rouge">../../../../%23</code> Notice that this returns a <code class="language-plaintext highlighter-rouge">Not found</code> response. ==This indicates that you’ve navigated outside the API root.==</p>
  </li>
  <li>
    <p>At this level, ==add some common API definition filenames to the URL path.== For example, submit the following:</p>

    <p><code class="language-plaintext highlighter-rouge">username=../../../../openapi.json%23</code></p>

    <p>Notice that this returns an error message, which contains the following API endpoint for finding users:</p>

    <p><code class="language-plaintext highlighter-rouge">/api/internal/v1/users/{username}/field/{field}</code></p>

    <p>Notice that this endpoint indicates that the URL path includes a parameter called <code class="language-plaintext highlighter-rouge">field</code>.</p>
  </li>
</ol>

<h2 id="exploit-the-vulnerability">Exploit the vulnerability</h2>

<ol>
  <li>
    <p>Update the value of the <code class="language-plaintext highlighter-rouge">username</code> parameter, using the structure of the identified endpoint. Add an invalid value for the <code class="language-plaintext highlighter-rouge">field</code> parameter:</p>

    <p><code class="language-plaintext highlighter-rouge">username=administrator/field/foo%23</code></p>

    <p>Send the request. Notice that this returns an error message, because the API only supports the email field.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">email</code> as the value of the <code class="language-plaintext highlighter-rouge">field</code> parameter:</p>

    <p><code class="language-plaintext highlighter-rouge">username=administrator/field/email%23</code></p>

    <p>Send the request. Notice that this returns the original response. This may indicate that the server-side application recognizes the injected <code class="language-plaintext highlighter-rouge">field</code> parameter and that <code class="language-plaintext highlighter-rouge">email</code> is a valid field type.</p>
  </li>
  <li>
    <p>In <strong>Proxy &gt; HTTP history</strong>, review the <code class="language-plaintext highlighter-rouge">/static/js/forgotPassword.js</code> JavaScript file. Identify the password reset endpoint, which refers to the <code class="language-plaintext highlighter-rouge">passwordResetToken</code> parameter:</p>

    <p><code class="language-plaintext highlighter-rouge">/forgot-password?passwordResetToken=${resetToken}</code></p>
  </li>
  <li>
    <p>In the <strong>Repeater</strong> tab, change the value of the <code class="language-plaintext highlighter-rouge">field</code> parameter from <code class="language-plaintext highlighter-rouge">email</code> to <code class="language-plaintext highlighter-rouge">passwordResetToken</code>:</p>

    <p><code class="language-plaintext highlighter-rouge">username=administrator/field/passwordResetToken%23</code></p>

    <p>Send the request. Notice that this returns an error message, because the <code class="language-plaintext highlighter-rouge">passwordResetToken</code> parameter is not supported by the version of the API that is set by the application.</p>
  </li>
  <li>
    <p>Using the <code class="language-plaintext highlighter-rouge">/api/</code> endpoint that you identified earlier, change the version of the API in the value of the <code class="language-plaintext highlighter-rouge">username</code> parameter:</p>

    <p><code class="language-plaintext highlighter-rouge">username=../../v1/users/administrator/field/passwordResetToken%23</code></p>

    <p>Send the request. Notice that this returns a password reset token. Make a note of this.</p>
  </li>
  <li>
    <p>In Burp’s browser, enter the password reset endpoint in the address bar. Add your password reset token as the value of the <code class="language-plaintext highlighter-rouge">reset_token</code> parameter. For example:</p>

    <p><code class="language-plaintext highlighter-rouge">/forgot-password?passwordResetToken=123456789</code></p>
  </li>
  <li>
    <p>Set a new password.</p>
  </li>
  <li>
    <p>Log in as the <code class="language-plaintext highlighter-rouge">administrator</code> using your password.</p>
  </li>
</ol>


      <div class="footer">
        <span class="muted">© 2025 · Generado con Jekyll</span>
      </div>
    </div>
  </main>
</body>
</html>

